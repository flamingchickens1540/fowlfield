// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

enum Match_State {
  not_started
  in_progress
  ended
  posted
}

enum Match_Type {
  qualification
  elimination
}

type Match_ElimInfo {
  round         Int
  group         Int
  instance      Int
  red_alliance  Int
  blue_alliance Int
}

enum Card {
  none
  yellow
  red
}

model Match {
  id          String          @id @map("_id")
  stage_index Int
  type        Match_Type
  elim_info   Match_ElimInfo?
  startTime   Int?
  state       Match_State
  red1        Int
  red2        Int
  red3        Int
  blue1       Int
  blue2       Int
  blue3       Int
  scores      Match_Results

  @@unique([stage_index, type])
}

type Match_Results {
  red          Match_AllianceResults
  blue         Match_AllianceResults
  cabbages_in_patch Boolean // Whether both cabages are in the carrot patch at the end of the match (coopertition)
}

type Match_AllianceResults {
  card_robot1       Card // The card for the first robot on the alliance
  card_robot2       Card // The card for the second robot on the alliance
  card_robot3       Card // The card for the third robot on the alliance
  
  feeding_station_auto      Int // The number of carrots in the feeding station at the end of auto
  feeding_station_tele      Int // The number of carrots in the feeding station at the end of the match (this includes carrots placed during auto)
  grass_auto                Int // The number of carrots in the grass at the end of auto
  grass_tele                Int // The number of carrots in the grass at the end of the match (this includes carrots placed during auto)
  endgame_bunnies           Int // The number of bunnies in the petting zoo at the end of the match

  total_hits                Int // The number of carrots that successfully hit opponent robots

  auto_park_robot1       Boolean // Whether the first robot ends auto partially inside the carrot patch
  auto_park_robot2       Boolean // Whether the second robot ends auto partially inside the carrot patch
  auto_park_robot3       Boolean // Whether the third robot ends auto partially inside the carrot patch

  foul_points       Int // The number a points an alliance earns from fouls
}

model Team {
  id             Int     @id @map("_id")
  team_name      String?
  robot_name     String?
  display_number String  @unique
  has_card       Boolean @default(false)
}

model PlayoffAlliance {
  seed        Int  @id @map("_id")
  captain     Int?
  first_pick  Int?
  second_pick Int?
  third_pick  Int?
}
